import pandas as pd
import numpy as np

# 대구 데이터셋의 카테고리만 사용
CATEGORY_KEYWORDS = [
    ("한식", ["칼국수", "국밥", "한정식", "삼겹살", "갈비", "보쌈", "막창", "순대", "비빔밥", "찜", "불고기", "전골", "전", "탕", "찌개", "닭갈비", "삼계탕", "떡볶이", "분식", "콩국수", "두부", "낙지", "오징어", "곰탕", "설렁탕", "육개장", "족발", "찜갈비", "닭도리탕", "닭똥집", "오리", "돼지", "소고기", "한우", "돼지고기", "닭고기"]),
    ("일식", ["초밥", "스시", "돈까스", "카츠", "우동", "라멘", "사케", "이자카야", "덮밥", "규동"]),
    ("중식", ["짜장", "짬뽕", "탕수육", "중화", "중식", "만두", "마라", "꿔바로우"]),
    ("양식", ["파스타", "스테이크", "피자", "버거", "양식", "리조또", "샐러드"]),
    ("세계요리", ["쌀국수", "팟타이", "베트남", "태국", "인도", "커리", "케밥"]),
    ("전통차/커피전문점", ["카페", "커피", "전통차", "다방", "티", "에스프레소"]),
    ("디저트/베이커리", ["케이크", "빵", "베이커리", "디저트", "브런치", "샌드위치", "타르트", "크로와상", "토스트", "쿠키"]),
    ("특별한 술집", ["술집", "포차", "호프", "펍", "바", "와인", "이자카야", "브루어리", "브루펍"]),
]

# 데이터 불러오기
df = pd.read_csv('data/gwangju_restaurant_with_coords.csv')

def guess_category(name):
    for cat, keywords in CATEGORY_KEYWORDS:
        for kw in keywords:
            if kw in str(name):
                return cat
    return "기타"

# 음식점명 기준으로 음식 종류 자동 분류
df['음식 종류'] = df['음식점명'].apply(guess_category)

# 저장
df.to_csv('data/gwangju_restaurant_with_coords.csv', index=False, encoding='utf-8-sig')
print('음식 종류 자동 분류 및 저장이 완료되었습니다.') 